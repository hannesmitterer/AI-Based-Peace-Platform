# TLS 1.3 Configuration
# Hardened communication protocol settings

[tls]
# Minimum TLS version
min_version = "1.3"
max_version = "1.3"

# Cipher suites (TLS 1.3)
cipher_suites = [
    "TLS_AES_256_GCM_SHA384",
    "TLS_CHACHA20_POLY1305_SHA256",
    "TLS_AES_128_GCM_SHA256"
]

# Certificate settings
[certificates]
cert_file = "/etc/ssl/certs/platform-cert.pem"
key_file = "/etc/ssl/private/platform-key.pem"
ca_file = "/etc/ssl/certs/ca-bundle.crt"

# Require client certificates
require_client_cert = true
verify_client = true

# Certificate pinning
enable_cert_pinning = true
pinned_certs = []

[security]
# Disable older protocols
disable_ssl_v2 = true
disable_ssl_v3 = true
disable_tls_v1_0 = true
disable_tls_v1_1 = true
disable_tls_v1_2 = true

# Disable unencrypted communication
allow_unencrypted = false
enforce_https = true

# HSTS settings
enable_hsts = true
hsts_max_age = 31536000
hsts_include_subdomains = true
hsts_preload = true

# Session settings
session_timeout = 3600
session_cache_size = 20480
session_tickets = false  # Disable for better forward secrecy

[quic]
# QUIC protocol settings
enabled = true
port = 4433
max_idle_timeout = 60
max_datagram_size = 1280

# QUIC-specific security
enable_0rtt = false  # Disable 0-RTT for better security
require_address_validation = true

[headers]
# Security headers
strict_transport_security = "max-age=31536000; includeSubDomains; preload"
x_content_type_options = "nosniff"
x_frame_options = "DENY"
x_xss_protection = "1; mode=block"
content_security_policy = "default-src 'self'; script-src 'self'; style-src 'self'"
referrer_policy = "strict-origin-when-cross-origin"

[logging]
# Log TLS handshakes and errors
log_handshakes = true
log_errors = true
log_level = "INFO"
log_file = "/var/log/tls/tls_connections.log"

[monitoring]
# Monitor for downgrade attacks
detect_downgrade = true
alert_on_old_protocol = true
alert_email = "security@example.com"
